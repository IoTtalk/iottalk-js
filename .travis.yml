language: node_js

node_js:
  - "11"

branches:
  except:
    - gh-pages

notifications:
  email: false

script:
  - yarn run build

# https://docs.travis-ci.com/user/deployment/pages/

before_deploy:
  - mv ./build-web/dan2-web.js ./build-web/dan2.js
  - ln -s ./build-web/dan2.js ./build-web/dan2-${TRAVIS_COMMIT}.js
  - if [ "${TRAVIS_TAG}" ]; then
      ln -s ./build-web/dan2.js ./build-web/dan2-${TRAVIS_TAG}.js
    fi

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  keep_history: true
  local_dir:
    - ./build-web
  on:
    branch: master
